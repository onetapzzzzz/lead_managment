# Telegram Bot –Ω–∞ Python (aiogram)

## –û–ø–∏—Å–∞–Ω–∏–µ

Telegram –±–æ—Ç –Ω–∞–ø–∏—Å–∞–Ω –Ω–∞ Python —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º aiogram 3.x. –ë–æ—Ç –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω —Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º Next.js –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —É–¥–æ–±–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ª–∏–¥–∞–º–∏ —á–µ—Ä–µ–∑ Telegram.

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```bash
cd bot
pip install -r requirements.txt
```

–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ:

```bash
python -m venv venv
source venv/bin/activate  # –ù–∞ Windows: venv\Scripts\activate
pip install -r requirements.txt
```

### 2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –ø–∞–ø–∫–µ `bot/`:

```env
TELEGRAM_BOT_TOKEN=7778919356:AAH0Uo7WraLEkqHQccEWRZTMm_TrAuRQx9Y
WEB_APP_URL=http://localhost:3000
DATABASE_URL=postgresql://leads_user:leads_password@localhost:5432/leads_db
BOT_API_PORT=8001
```

## –ó–∞–ø—É—Å–∫

### –†–µ–∂–∏–º 1: Polling (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)

–ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞ –≤ —Ä–µ–∂–∏–º–µ polling:

```bash
python bot/main.py
```

### –†–µ–∂–∏–º 2: Webhook (–¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞)

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ API —Å–µ—Ä–≤–µ—Ä –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:

```bash
python bot/api_server.py
```

2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ webhook —á–µ—Ä–µ–∑ Telegram Bot API:

```bash
curl -X POST "https://api.telegram.org/bot<TOKEN>/setWebhook?url=https://your-domain.com/api/bot/webhook"
```

3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞:

```bash
python bot/main.py
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
bot/
‚îú‚îÄ‚îÄ main.py           # –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª –±–æ—Ç–∞ —Å –∫–æ–º–∞–Ω–¥–∞–º–∏ –∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞–º–∏
‚îú‚îÄ‚îÄ api_server.py     # HTTP API —Å–µ—Ä–≤–µ—Ä –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
‚îú‚îÄ‚îÄ api_client.py     # –ö–ª–∏–µ–Ω—Ç –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é)
‚îú‚îÄ‚îÄ requirements.txt  # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îî‚îÄ‚îÄ README.md         # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

### –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞:
- `/start` - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
- `/help` - –°–ø—Ä–∞–≤–∫–∞ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –±–æ—Ç–∞
- `/stats` - –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `/balance` - –ü–æ–∫–∞–∑–∞—Ç—å –±–∞–ª–∞–Ω—Å –ø–æ–∏–Ω—Ç–æ–≤

### –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –∫–Ω–æ–ø–∫–∏:
- üöÄ **–û—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ** - –û—Ç–∫—Ä—ã–≤–∞–µ—Ç –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ Telegram WebApp
- üìä **–ú–æ—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ/–ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –ª–∏–¥—ã –∏ –±–∞–ª–∞–Ω—Å
- üí∞ **–ë–∞–ª–∞–Ω—Å** - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å –∏ –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- üì§ **–ó–∞–≥—Ä—É–∑–∏—Ç—å –ª–∏–¥—ã** - –û—Ç–∫—Ä—ã–≤–∞–µ—Ç —Ñ–æ—Ä–º—É –∑–∞–≥—Ä—É–∑–∫–∏ –ª–∏–¥–æ–≤
- üì• **–ú–æ–∏ –ª–∏–¥—ã** - –û—Ç–∫—Ä—ã–≤–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –ª–∏–¥–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:
–ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ:
- ‚úÖ –£—Å–ø–µ—à–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–µ –ª–∏–¥–æ–≤ (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –∏ –Ω–∞—á–∏—Å–ª–µ–Ω–Ω—ã–µ –ø–æ–∏–Ω—Ç—ã)
- üéâ –ü–æ–∫—É–ø–∫–µ –ª–∏–¥–∞ (—Ç–µ–ª–µ—Ñ–æ–Ω, –ø–æ—Ç—Ä–∞—á–µ–Ω–Ω—ã–µ –ø–æ–∏–Ω—Ç—ã, –Ω–æ–≤—ã–π –±–∞–ª–∞–Ω—Å)

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Next.js

–ë–æ—Ç –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω —Å Next.js —á–µ—Ä–µ–∑ HTTP API:

1. Next.js API endpoints –≤—ã–∑—ã–≤–∞—é—Ç `/api/bot/notify`
2. –≠—Ç–æ—Ç endpoint –ø—Ä–æ–∫—Å–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ Python API —Å–µ—Ä–≤–µ—Ä (`bot/api_server.py`)
3. Python —Å–µ—Ä–≤–µ—Ä –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ Telegram Bot API

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

–î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–µ–∂–∏–º polling:

```bash
python bot/main.py
```

–ë–æ—Ç –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ—Ç Telegram.

## –ü—Ä–æ–¥–∞–∫—à–µ–Ω

–î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ API —Å–µ—Ä–≤–µ—Ä:
```bash
python bot/api_server.py
```

2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ webhook (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):
```bash
curl -X POST "https://api.telegram.org/bot<TOKEN>/setWebhook?url=https://your-domain.com/api/bot/webhook"
```

3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞:
```bash
python bot/main.py
```

## –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

- `TELEGRAM_BOT_TOKEN` - –¢–æ–∫–µ–Ω Telegram –±–æ—Ç–∞
- `WEB_APP_URL` - URL –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- `DATABASE_URL` - URL –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ PostgreSQL
- `BOT_API_PORT` - –ü–æ—Ä—Ç –¥–ª—è HTTP API —Å–µ—Ä–≤–µ—Ä–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 8001)





